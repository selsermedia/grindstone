if(typeof jslang=="undefined"){LoadLangD("EN")}else{if(jslang=="JP"){jslang="JA"}if(jslang=="CS"){jslang="CZ"}if(jslang=="SI"){jslang="SL"}LoadLangD(jslang)}function LoadLangD(a){var b=document.createElement("script");b.setAttribute("src","/BcJsLang/Java_DatePicker.aspx?lang="+a);b.setAttribute("charset","utf-8");b.setAttribute("type","text/javascript");document.getElementsByTagName("head")[0].appendChild(b)}var datePickerDivID="datepicker";var iFrameDivID="datepickeriframe";var dayArrayShort;var monthArrayShort;var dateSeparator="-";var datePickerInit=0;function InitDatePicker(){dayArrayShort=new Array(dpicklang.Su,dpicklang.Mo,dpicklang.Tu,dpicklang.We,dpicklang.Th,dpicklang.Fr,dpicklang.Sa);monthArrayShort=new Array(dpicklang.Jan,dpicklang.Feb,dpicklang.Mar,dpicklang.Apr,dpicklang.May,dpicklang.Jun,dpicklang.Jul,dpicklang.Aug,dpicklang.Sep,dpicklang.Oct,dpicklang.Nov,dpicklang.Dec);datePickerInit=1}if(document.all){document.onmousedown=captureMousePosition}else{if(document.getElementById){document.onmousedown=captureMousePosition}}var mousex;var mousey;function captureMousePosition(a){if(document.all){mousex=window.event.x+document.body.scrollLeft;if(document.documentElement&&document.documentElement.scrollTop>0){mousey=window.event.y+document.documentElement.scrollTop}else{mousey=window.event.y+document.body.scrollTop}}else{if(document.getElementById){mousex=a.pageX;mousey=a.pageY}}}function displayDatePicker(b){if(datePickerInit==0){InitDatePicker()}var d=document.getElementById(b);var a=d.offsetLeft;var e=d.offsetTop+d.offsetHeight;var c=d;while(c.offsetParent){c=c.offsetParent;a+=c.offsetLeft;e+=c.offsetTop}if(mousex<a){a=mousex}if(mousey<e){e=mousey}drawDatePicker(d,a,e)}function drawDatePicker(d,b,c){var e=getFieldDate(d.value);if(!document.getElementById(datePickerDivID)){var f=document.createElement("div");f.setAttribute("id",datePickerDivID);f.setAttribute("class","dpDiv");f.setAttribute("style","visibility: hidden; padding: 9px; color: #666666");document.body.appendChild(f)}var a=document.getElementById(datePickerDivID);a.style.position="absolute";a.style.left=b+"px";a.style.top=c+"px";a.style.border="1px solid #999999";a.style.backgroundColor="#ffffff";a.style.visibility=(a.style.visibility=="visible"?"hidden":"visible");a.style.zIndex=900000000;refreshDatePicker(d.name,e.getFullYear(),e.getMonth(),e.getDate())}function refreshDatePicker(j,k,p,r){var e=new Date();if((p>=0)&&(k>0)){e=new Date(k,p,1)}else{r=e.getDate();e.setDate(1)}var B="\r\n";var g="<style>.text {font: 10px arial; color: #666666}</style>"+B;var w="<table class='date'>"+B;var x="</table>"+B;var v="<tr style='cursor:hand'>";var u="<tr>";var z="<tr>";var y="</tr>"+B;var s="<td>";var c="<td align='center' colspan='7' style='text-align: center'>";var C="<td>";var f="<td align='center' colspan='7'>";var A="<td style='border-bottom: 1px solid #f0f0f0; text-align: center; font-size: 9px; color: #999;'>";var d="<td style='text-align: center; color: #666666; font-size: 10px; padding: 3px' ";var o="</td>"+B;var b="<div>";var h="<div style='background: #005ba7; color: #ffffff'>";var l="</div>";var t=g+w;t+=v+c;t+="<select id='ddMonth' style='font: 10px Arial;' onChange='refreshDatePicker(\""+j+'", document.getElementById("ddYear").value, this.options[this.selectedIndex].value);\'>';for(var m=0;m<=11;m++){if(e.getMonth()==m){t+="<option selected value="+m+">"+monthArrayShort[m]+"</option>"}else{t+="<option value="+m+">"+monthArrayShort[m]+"</option>"}}t+="</select>";t+="<select id='ddYear' style='font: 10px Arial;' onChange='refreshDatePicker(\""+j+'", this.options[this.selectedIndex].value, document.getElementById("ddMonth").value);\'>';for(m=1920;m<=2099;m++){if(e.getFullYear()==m){t+="<option selected value="+m+">"+m+"</option>"}else{t+="<option value="+m+">"+m+"</option>"}}t+="</select>";t+=o+y;t+=u;for(m=0;m<dayArrayShort.length;m++){t+=A+dayArrayShort[m]+o}t+=y;t+=v;for(m=0;m<e.getDay();m++){t+=s+"&nbsp;"+o}do{var n=e.getDate();TD_onclick=" onclick=\"updateDateField('"+j+"', '"+getDateString(e)+"');\">";if(n==r){t+=d+TD_onclick+h+n+l+o}else{t+=d+TD_onclick+n+o}if(e.getDay()==6){t+=y+v}e.setDate(e.getDate()+1)}while(e.getDate()>1);if(e.getDay()>0){for(m=6;m>e.getDay();m--){t+=s+"&nbsp;"+o}}t+=y;var q=new Date();var a="Today is "+dayArrayShort[q.getDay()]+", "+monthArrayShort[q.getMonth()]+" "+q.getDate();t+=z+f;t+="<button class='button' style='font: 10px arial;background-color:white;' onClick='refreshDatePicker(\""+j+"\");'>"+dpicklang.Today+"</button> ";t+="<button class='button' style='font: 10px arial;background-color:white;' onClick='clearDateField(\""+j+"\");'>"+dpicklang.Clear+"</button> ";t+="<button class='button' style='font: 10px arial;background-color:white;' onClick='updateDateField(\""+j+"\");'>"+dpicklang.Close+"</button>";t+=o+y;t+=x;document.getElementById(datePickerDivID).innerHTML=t;if(document.all){adjustiFrame()}}function getDateString(b){var a="00"+b.getDate();var c=monthArrayShort[b.getMonth()];a=a.substring(a.length-2);return a+dateSeparator+c+dateSeparator+b.getFullYear()}function getFieldDate(h){var g;if(h.length==0){g=new Date();return g}var f,c,e;var j=h.indexOf(dateSeparator);var b=h.indexOf(dateSeparator,j+1);f=h.substring(0,j);c=h.substring(j+1,b);for(var a=0;a<monthArrayShort.length;a++){if(monthArrayShort[a]==c){c=a}}e=h.substring(b+1);if(e>2099){f=31;c=11;e=2099}g=new Date(e,c,f);return g}function updateDateField(b,a){var c=document.getElementsByName(b).item(0);if(a){c.value=a}hideDatePicker();if((a)&&(typeof(datePickerClosed)=="function")){datePickerClosed(c)}}function hideDatePicker(){if(document.getElementById(datePickerDivID)){document.getElementById(datePickerDivID).style.visibility="hidden";adjustiFrame()}}function clearDateField(a){var b=document.getElementsByName(a).item(0);b.value=""}function adjustiFrame(a,b){if(!document.getElementById(iFrameDivID)){var d=document.createElement("iFrame");d.setAttribute("id",iFrameDivID);d.setAttribute("src","javascript:false;");d.setAttribute("scrolling","no");d.setAttribute("frameborder","0");document.body.appendChild(d)}if(!a){a=document.getElementById(datePickerDivID)}if(!b){b=document.getElementById(iFrameDivID)}try{b.style.position="absolute";b.style.width=a.offsetWidth;b.style.height=a.offsetHeight;b.style.top=a.style.top;b.style.left=a.style.left;b.style.zIndex=a.style.zIndex-1;b.style.visibility=a.style.visibility}catch(c){}}function DisplayTextBox(e,f){var b=document.getElementById("Days");var c=document.getElementById("LBDays");var d=document.getElementById("neverRB");var a=document.getElementById("daysRB");if(e==a){b.style.display="inline";c.style.display="inline";b.value=f;setTimeout(function(){a.checked=true;d.checked=false},0)}else{if(e==d){b.style.display="none";c.style.display="none";b.value=f;setTimeout(function(){d.checked=true;a.checked=false},0)}}};